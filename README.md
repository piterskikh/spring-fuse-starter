# spring-fuse-starter

Spring Fuse Starter — это стартер для Spring Boot, которая позволяет автоматически собирать несколько последовательных вызовов методов findById в единый массовый запрос findAllById.



**(findById - это начальный этап развития стартера, в дальнейшем в любом репозитории Spring Data, достаточно будет поставить аннотацию @Fusible над любым методом который выполняет запрос из БД)**



Основные задачи и преимущества

Когда в коде многократно подряд вызывают findById, это приводит к множеству отдельных SQL-запросов. Fuse Starter объединяет их в один, что существенно снижает нагрузку на базу данных и ускоряет выполнение.

Прозрачность для разработчика
Всё, что нужно — пометить метод findById аннотацией @Fusible. Дальше фреймворк сам перехватывает эти вызовы и управляет их объединением, не требуя изменения бизнес-логики.

Конфигурируемое окно ожидания
Между первым и «спайсом» запросами задаётся «окно» в миллисекунды (по умолчанию — 1 мс, можно увеличить через fuse.windowMillis). В течение этого времени все новые вызовы на ту же репозиторию накапливаются в «баффер», затем разом запрашиваются.

Минимальные изменения в проекте
Не нужно вручную писать дополнительные слои или сервисы для батчинга: достаточно включить стартер, добавить аннотацию и указать параметр времени в настройках.

Совместимость с современными Java-фичами
Fuse Starter не мешает использованию виртуальных потоков Java 21 и подходит для любых режимов исполнения, гарантируя, что сами потоки не блокируются надолго.

Как это работает внутри
При первом вызове аннотированного метода сохраняется идентификатор и запускается таймер на заданное количество миллисекунд.

Все последующие вызовы того же метода в рамках окна тоже попадают в один «баффер».

По истечении тайм-аута все накопленные идентификаторы передаются в единый вызов findAllById.

Результаты этого массового запроса распределяются обратно по ожидающим вызовам, и каждый метод получает свою сущность или null/Optional.empty().

В итоге разработчик получает простую в использовании и эффективную систему автоматического батчинга запросов к базе.